{% extends "base.html" %}
{% load static %}

{% block title %}HandyNepal - Collections{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/collections.css' %}?v={% now 'U' %}">
{% endblock %}
 
{% block content %}
<!-- Collections Header Section -->
<div class="collections-header">
   <div class="container">
      <h1 class="collections-title">Our Collections</h1>
      <p class="collections-subtitle">Explore our curated selection of authentic Nepalese handicrafts</p>
   </div>
</div>

<!-- Category Filter Section -->
<div class="filter-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-3">
                <div class="filter-container">
                    <h4 class="filter-title">Categories</h4>
                    <div class="filter-group">
                        <div class="form-check">
                            <input class="form-check-input category-filter" type="checkbox" value="wood-crafts" id="woodCrafts">
                            <label class="form-check-label" for="woodCrafts">
                                Wood Crafts
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input category-filter" type="checkbox" value="pottery" id="pottery">
                            <label class="form-check-label" for="pottery">
                                Pottery
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input category-filter" type="checkbox" value="textiles" id="textiles">
                            <label class="form-check-label" for="textiles">
                                Textiles
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input category-filter" type="checkbox" value="metal-works" id="metalWorks">
                            <label class="form-check-label" for="metalWorks">
                                Metal Works
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input category-filter" type="checkbox" value="paper-crafts" id="paperCrafts">
                            <label class="form-check-label" for="paperCrafts">
                                Paper Crafts
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input category-filter" type="checkbox" value="jewelry" id="jewelry">
                            <label class="form-check-label" for="jewelry">
                                Jewelry
                            </label>
                        </div>
                    </div>

                    <h4 class="filter-title mt-4">Price Range</h4>
                    <div class="filter-group">
                        <div class="price-slider-container">
                            <div class="price-range">
                                <span id="priceMin">$0</span>
                                <span id="priceMax">$200</span>
                            </div>
                            <input type="range" class="form-range" min="0" max="200" step="10" id="priceRange">
                        </div>
                    </div>

                    <h4 class="filter-title mt-4">Artisan</h4>
                    <div class="filter-group">
                        {% for artisan in all_artisans %}
                        <div class="form-check">
                            <input class="form-check-input artisan-filter" type="checkbox" value="{{ artisan.first_name|lower }}-{{ artisan.last_name|lower }}" id="artisan{{ artisan.id }}">
                            <label class="form-check-label" for="artisan{{ artisan.id }}">
                                {{ artisan.first_name }} {{ artisan.last_name }}
                            </label>
                        </div>
                        {% empty %}
                        <p>No artisans available</p>
                        {% endfor %}
                    </div>

                    <button class="btn btn-primary w-100 mt-4" id="applyFilters">Apply Filters</button>
                    <button class="btn btn-outline-secondary w-100 mt-2" id="clearFilters">Clear All</button>
                </div>
            </div>
            
            <div class="col-lg-9">
                <div class="sorting-container d-flex justify-content-between align-items-center mb-4">
                    <div class="showing-results">
                        Showing <span id="productCount">{{ products|length }}</span> products
                    </div>
                    <div class="sort-options d-flex align-items-center">
                        <label for="sortSelect" class="me-2">Sort by:</label>
                        <select class="form-select" id="sortSelect">
                            <option value="featured">Featured</option>
                            <option value="price-low">Price: Low to High</option>
                            <option value="price-high">Price: High to Low</option>
                            <option value="newest">Newest</option>
                            <option value="bestselling">Best Selling</option>
                        </select>
                    </div>
                </div>

                <!-- Product Grid -->
                <div class="row g-4" id="productGrid">
                    {% include "main/partials/product_grid.html" %}
                </div>

                <!-- Pagination -->
                <nav class="mt-5">
                    <ul class="pagination justify-content-center">
                        <li class="page-item disabled">
                            <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Previous</a>
                        </li>
                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item">
                            <a class="page-link" href="#">Next</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>

<!-- Quick View Modal -->
<div class="modal fade" id="quickViewModal" tabindex="-1" aria-labelledby="quickViewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="quickViewModalLabel">Product Quick View</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <img id="quickViewImage" src="" class="img-fluid rounded" alt="Product Image">
                    </div>
                    <div class="col-md-6">
                        <h3 id="quickViewTitle" class="mb-3"></h3>
                        <div class="product-price mb-3" id="quickViewPrice"></div>
                        <p id="quickViewDescription" class="mb-4"></p>
                        
                        <div class="mb-4">
                            <label for="quickViewQuantity" class="form-label fw-bold">Quantity:</label>
                            <div class="input-group quantity-control" style="width: 130px;">
                                <button class="btn quantity-btn" type="button" id="decreaseQuantity">-</button>
                                <input type="number" class="form-control text-center" id="quickViewQuantity" value="1" min="1">
                                <button class="btn quantity-btn" type="button" id="increaseQuantity">+</button>
                            </div>
                        </div>
                        
                        <div id="quickViewStock" class="mb-3 text-muted"></div>
                        <div id="quickViewArtisan" class="mb-3 fst-italic"></div>
                        
                        <div class="d-grid gap-2">
                            <button class="btn btn-primary w-100 mb-2" id="quickViewAddToCart">
                                <i class="fas fa-shopping-cart me-2"></i> Add to Cart
                            </button>
                            <button class="btn btn-outline-primary w-100" id="quickViewAddToWishlist">
                                <i class="far fa-heart me-2"></i> Add to Wishlist
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Hidden Product Data for Quick View -->
<div style="display: none;" id="product-data-container">
    <!-- Product data will be loaded dynamically with the product grid -->
</div>

<!-- Cart Modal -->
<div class="modal fade" id="cartModal" tabindex="-1" aria-labelledby="cartModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="cartModalLabel">Shopping Cart</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="cart-items">
                    <!-- Cart items will be dynamically added here -->
                </div>
                <div class="cart-total mt-3 pt-3 border-top">
                    <div class="d-flex justify-content-between">
                        <span class="font-weight-bold">Total:</span>
                        <span class="font-weight-bold" id="cart-total">$0.00</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Continue Shopping</button>
                <a href="#" class="btn btn-primary">Checkout</a>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script src="{% static 'js/collections.js' %}?v={% now 'U' %}"></script>
{% endblock %} 