{% extends "base.html" %}
{% load static %}

{% block title %}HandyNepal - Our Artisans{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/artisans.css' %}?v={% now 'U' %}">
{% endblock %}
 
{% block content %}
<!-- Artisans Header Section -->
<div class="artisans-header">
   <div class="container">
      <h1 class="artisans-title">Meet Our Artisans</h1>
      <p class="artisans-subtitle">The skilled craftspeople behind our authentic Nepalese handicrafts</p>
   </div>
</div>

<!-- Artisans Introduction -->
<div class="artisans-intro">
   <div class="container">
      <div class="row align-items-center">
         <div class="col-lg-6">
            <div class="intro-content">
               <h2>The Heart of HandyNepal</h2>
               <p>Our artisans are the soul of our business. Each product in our collection is handcrafted by skilled artisans who have inherited generations of craftsmanship knowledge and techniques.</p>
               <p>We work directly with over 50 artisans across Nepal, ensuring fair compensation and sustainable livelihoods while preserving traditional crafts that might otherwise be lost to time.</p>
               <div class="intro-stats">
                  <div class="stat-item">
                     <span class="stat-number">50+</span>
                     <span class="stat-label">Artisans</span>
                  </div>
                  <div class="stat-item">
                     <span class="stat-number">15+</span>
                     <span class="stat-label">Villages</span>
                  </div>
                  <div class="stat-item">
                     <span class="stat-number">6</span>
                     <span class="stat-label">Craft Types</span>
                  </div>
               </div>
            </div>
         </div>
         <div class="col-lg-6">
            <div class="intro-image">
               <img src="{% static 'images\Cover-Story-Artisans.png' %}" alt="Artisan Working" onerror="this.src='https://via.placeholder.com/600x400?text=Artisan+Working'">
            </div>
         </div>
      </div>
   </div>
</div>

<!-- Featured Artisans -->
<div class="featured-artisans">
   <div class="container">
      <h2 class="section-title">Featured Artisans</h2>
      <p class="section-subtitle">Meet the master craftspeople behind our most popular collections</p>
      
      <!-- Artisan Carousel -->
      <div id="artisanCarousel" class="carousel slide" data-bs-ride="carousel">
         <div class="carousel-indicators">
            <button type="button" data-bs-target="#artisanCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#artisanCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#artisanCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
            <button type="button" data-bs-target="#artisanCarousel" data-bs-slide-to="3" aria-label="Slide 4"></button>
         </div>
         
         <div class="carousel-inner">
            <!-- First slide -->
            <div class="carousel-item active">
               <div class="row">
                  {% for artisan in artisans|slice:":3" %}
                  <div class="col-md-4">
                     <div class="artisan-card" data-bs-toggle="modal" data-bs-target="#artisanModal{{ artisan.id }}">
                        <div class="artisan-img-container">
                           {% if artisan.image %}
                           <img src="{{ artisan.image.url }}" class="artisan-img" alt="{{ artisan.first_name }} {{ artisan.last_name }}">
                           {% else %}
                           <img src="{% static 'images/artisan.png' %}" class="artisan-img" alt="{{ artisan.first_name }} {{ artisan.last_name }}" onerror="this.src='https://via.placeholder.com/300x200?text={{ artisan.first_name|urlencode }}+{{ artisan.last_name|urlencode }}'">
                           {% endif %}
                           <div class="artisan-overlay">
                              <span class="btn-view-profile">View Profile</span>
                           </div>
                        </div>
                        <div class="artisan-content">
                           <h3 class="artisan-name">{{ artisan.first_name }} {{ artisan.last_name }}</h3>
                           <p class="artisan-specialty">{{ artisan.get_artisan_type_display }}</p>
                           <p class="artisan-location"><i class="fas fa-map-marker-alt"></i> {{ artisan.location }}</p>
                           <div class="artisan-skills">
                              <span>{{ artisan.get_artisan_type_display }}</span>
                           </div>
                        </div>
                     </div>
                  </div>
                  {% endfor %}
               </div>
            </div>
            
            <!-- Second slide -->
            <div class="carousel-item">
               <div class="row">
                  {% for artisan in artisans|slice:"3:6" %}
                  <div class="col-md-4">
                     <div class="artisan-card" data-bs-toggle="modal" data-bs-target="#artisanModal{{ artisan.id }}">
                        <div class="artisan-img-container">
                           {% if artisan.image %}
                           <img src="{{ artisan.image.url }}" class="artisan-img" alt="{{ artisan.first_name }} {{ artisan.last_name }}">
                           {% else %}
                           <img src="{% static 'images/artisan.png' %}" class="artisan-img" alt="{{ artisan.first_name }} {{ artisan.last_name }}" onerror="this.src='https://via.placeholder.com/300x200?text={{ artisan.first_name|urlencode }}+{{ artisan.last_name|urlencode }}'">
                           {% endif %}
                           <div class="artisan-overlay">
                              <span class="btn-view-profile">View Profile</span>
                           </div>
                        </div>
                        <div class="artisan-content">
                           <h3 class="artisan-name">{{ artisan.first_name }} {{ artisan.last_name }}</h3>
                           <p class="artisan-specialty">{{ artisan.get_artisan_type_display }}</p>
                           <p class="artisan-location"><i class="fas fa-map-marker-alt"></i> {{ artisan.location }}</p>
                           <div class="artisan-skills">
                              <span>{{ artisan.get_artisan_type_display }}</span>
                           </div>
                        </div>
                     </div>
                  </div>
                  {% endfor %}
               </div>
            </div>
            
            <!-- Third slide -->
            <div class="carousel-item">
               <div class="row">
                  {% for artisan in artisans|slice:"6:9" %}
                  <div class="col-md-4">
                     <div class="artisan-card" data-bs-toggle="modal" data-bs-target="#artisanModal{{ artisan.id }}">
                        <div class="artisan-img-container">
                           {% if artisan.image %}
                           <img src="{{ artisan.image.url }}" class="artisan-img" alt="{{ artisan.first_name }} {{ artisan.last_name }}">
                           {% else %}
                           <img src="{% static 'images/artisan.png' %}" class="artisan-img" alt="{{ artisan.first_name }} {{ artisan.last_name }}" onerror="this.src='https://via.placeholder.com/300x200?text={{ artisan.first_name|urlencode }}+{{ artisan.last_name|urlencode }}'">
                           {% endif %}
                           <div class="artisan-overlay">
                              <span class="btn-view-profile">View Profile</span>
                           </div>
                        </div>
                        <div class="artisan-content">
                           <h3 class="artisan-name">{{ artisan.first_name }} {{ artisan.last_name }}</h3>
                           <p class="artisan-specialty">{{ artisan.get_artisan_type_display }}</p>
                           <p class="artisan-location"><i class="fas fa-map-marker-alt"></i> {{ artisan.location }}</p>
                           <div class="artisan-skills">
                              <span>{{ artisan.get_artisan_type_display }}</span>
                           </div>
                        </div>
                     </div>
                  </div>
                  {% endfor %}
               </div>
            </div>
            
            <!-- Fourth slide -->
            <div class="carousel-item">
               <div class="row">
                  {% for artisan in artisans|slice:"9:12" %}
                  <div class="col-md-4">
                     <div class="artisan-card" data-bs-toggle="modal" data-bs-target="#artisanModal{{ artisan.id }}">
                        <div class="artisan-img-container">
                           {% if artisan.image %}
                           <img src="{{ artisan.image.url }}" class="artisan-img" alt="{{ artisan.first_name }} {{ artisan.last_name }}">
                           {% else %}
                           <img src="{% static 'images/artisan.png' %}" class="artisan-img" alt="{{ artisan.first_name }} {{ artisan.last_name }}" onerror="this.src='https://via.placeholder.com/300x200?text={{ artisan.first_name|urlencode }}+{{ artisan.last_name|urlencode }}'">
                           {% endif %}
                           <div class="artisan-overlay">
                              <span class="btn-view-profile">View Profile</span>
                           </div>
                        </div>
                        <div class="artisan-content">
                           <h3 class="artisan-name">{{ artisan.first_name }} {{ artisan.last_name }}</h3>
                           <p class="artisan-specialty">{{ artisan.get_artisan_type_display }}</p>
                           <p class="artisan-location"><i class="fas fa-map-marker-alt"></i> {{ artisan.location }}</p>
                           <div class="artisan-skills">
                              <span>{{ artisan.get_artisan_type_display }}</span>
                           </div>
                        </div>
                     </div>
                  </div>
                  {% endfor %}
               </div>
            </div>
         </div>
         
         <button class="carousel-control-prev" type="button" data-bs-target="#artisanCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
         </button>
         <button class="carousel-control-next" type="button" data-bs-target="#artisanCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
         </button>
      </div>
      
      <!-- View All Artisans Button -->
      <div class="text-center mt-4">
         <a href="#" class="btn btn-outline-primary">View All Artisans</a>
      </div>
   </div>
</div>

<!-- Artisan Support Section -->
<div class="artisan-support">
   <div class="container">
      <div class="row align-items-center">
         <div class="col-lg-6">
            <div class="support-image">
               <img src="{% static 'images/artisan_page.png' %}" alt="Artisan Community" onerror="this.src='https://via.placeholder.com/600x400?text=Artisan+Community'">
            </div>
         </div>
         <div class="col-lg-6">
            <div class="support-content">
               <h2>Supporting Artisan Communities</h2>
               <p>At HandyNepal, we're committed to supporting artisan communities across Nepal. Through fair trade practices and direct partnerships, we ensure that our artisans receive fair compensation for their work.</p>
               <p>A portion of every purchase goes directly to community development initiatives, including education programs for artisans' children and healthcare services in remote villages.</p>
               <a href="#" class="btn-learn-more">Learn About Our Impact</a>
            </div>
         </div>
      </div>
   </div>
</div>

<!-- Artisan Modals -->
{% for artisan in artisans %}
<div class="modal fade" id="artisanModal{{ artisan.id }}" tabindex="-1" aria-labelledby="artisanModal{{ artisan.id }}Label" aria-hidden="true">
   <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
         <div class="modal-header">
            <h5 class="modal-title" id="artisanModal{{ artisan.id }}Label">{{ artisan.first_name }} {{ artisan.last_name }}</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
         </div>
         <div class="modal-body">
            <div class="row">
               <div class="col-md-5">
                  {% if artisan.image %}
                  <img src="{{ artisan.image.url }}" alt="{{ artisan.first_name }} {{ artisan.last_name }}" class="img-fluid rounded">
                  {% else %}
                  <img src="{% static 'images/artisan.png' %}" alt="{{ artisan.first_name }} {{ artisan.last_name }}" class="img-fluid rounded" onerror="this.src='https://via.placeholder.com/400x500?text={{ artisan.first_name|urlencode }}+{{ artisan.last_name|urlencode }}'">
                  {% endif %}
                  <div class="artisan-details mt-3">
                     <p><strong>Specialty:</strong> {{ artisan.get_artisan_type_display }}</p>
                     <p><strong>Location:</strong> {{ artisan.location }}</p>
                     <p><strong>Experience:</strong> {{ artisan.experience|default:"Varies" }}</p>
                     <p><strong>Products:</strong> {{ artisan.products|default:"Various Handicrafts" }}</p>
                  </div>
               </div>
               <div class="col-md-7">
                  <h4>Artisan Story</h4>
                  <p>{{ artisan.description|default:"This artisan is a skilled craftsperson from Nepal, dedicated to preserving traditional crafting techniques while creating beautiful handmade products." }}</p>
                  
                  <h4 class="mt-4">Featured Products</h4>
                  <div class="row g-2 mt-2">
                     <div class="col-4">
                        <img src="{% static 'images/product.png' %}" alt="Product" class="img-fluid rounded" onerror="this.src='https://via.placeholder.com/150x150?text=Product'">
                     </div>
                     <div class="col-4">
                        <img src="{% static 'images/product.png' %}" alt="Product" class="img-fluid rounded" onerror="this.src='https://via.placeholder.com/150x150?text=Product'">
                     </div>
                     <div class="col-4">
                        <img src="{% static 'images/product.png' %}" alt="Product" class="img-fluid rounded" onerror="this.src='https://via.placeholder.com/150x150?text=Product'">
                     </div>
                  </div>
               </div>
            </div>
         </div>
         <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <a href="{% url 'collections' %}?artisan={{ artisan.first_name|lower }}-{{ artisan.last_name|lower }}" class="btn btn-primary">View Products</a>
         </div>
      </div>
   </div>
</div>
{% endfor %}

{% block extra_js %}
<script>
   document.addEventListener('DOMContentLoaded', function() {
      // Initialize the carousel with options
      var artisanCarousel = new bootstrap.Carousel(document.getElementById('artisanCarousel'), {
         interval: 5000,  // Change slides every 5 seconds
         wrap: true,      // Continuous loop
         touch: true      // Enable touch swiping on mobile
      });
      
      // Pause carousel on modal open
      var artisanModals = document.querySelectorAll('[id^="artisanModal"]');
      artisanModals.forEach(function(modal) {
         modal.addEventListener('show.bs.modal', function() {
            artisanCarousel.pause();
         });
         
         modal.addEventListener('hidden.bs.modal', function() {
            artisanCarousel.cycle();
         });
      });
      
      // Add hover pause functionality
      var carouselElement = document.getElementById('artisanCarousel');
      carouselElement.addEventListener('mouseenter', function() {
         artisanCarousel.pause();
      });
      
      carouselElement.addEventListener('mouseleave', function() {
         artisanCarousel.cycle();
      });
      
      // Handle responsive behavior
      function adjustCarousel() {
         var width = window.innerWidth;
         var carouselItems = document.querySelectorAll('#artisanCarousel .carousel-item');
         
         if (width < 768) {
            // On mobile, ensure each artisan card is in its own slide
            carouselItems.forEach(function(item) {
               var row = item.querySelector('.row');
               if (row) {
                  var cards = row.querySelectorAll('.col-md-4');
                  cards.forEach(function(card, index) {
                     if (index > 0) {
                        card.style.display = 'none';
                     } else {
                        card.style.display = '';
                     }
                  });
               }
            });
         } else {
            // On desktop, show all cards in each slide
            carouselItems.forEach(function(item) {
               var row = item.querySelector('.row');
               if (row) {
                  var cards = row.querySelectorAll('.col-md-4');
                  cards.forEach(function(card) {
                     card.style.display = '';
                  });
               }
            });
         }
      }
      
      // Initial adjustment
      adjustCarousel();
      
      // Adjust on window resize
      window.addEventListener('resize', adjustCarousel);
   });
</script>
{% endblock %}

{% endblock %} 